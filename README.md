# DLS, семестр 1, продвинутый поток, итоговый проект
Тема проекта "Генерация изображений/SuperResolution"

### Струкртура репозитория:
1. checkpoints - папка для чекпоинтов модели
2. cyclegan - основной код модели
    1. block - базовые блоки, лежащие в основе дискриминатора и генератора (описаны в пункте **7.2** статьи)
    2. data - утилиты для подговки данных для модели
    3. loss - лосс функции
    4. model - модель CycleGan и генераторы и дискриминаторы
3. val_img - папка с тестовыми изображениями, генерируемыми после обучения модели

### Описание работы
Реализована архитектура CycleGan из статьи. 
Для дискриминатора и генератора реализована архитектура из текста статьи (описанные в пункте **7.2**, архитектуры представленные только в рефенсном коде не реализованы).
Обучение и тесты проводились на модели res-6 и размере изорабражения в 100х100 (GPU сервер на работе приболел, 
а без него на домашнем компьютере при residual-9 и 256х256 эпоха идет 10 минут и это без валидации, т.е. на 200 эпох уйдет почти 14 дней).
При таких параметрах модели и 100 эпохах обучение занимает 3 часа.

К 40 эпохе для изображений где лошади и зебры хорошо изображены (занимают центальное место на фото и ничем не заслонены) результат трансформаций выглядит весьма хорошо 
(каких-то специфичных метрик для этого нет (а цифры лосса дают только относительную информацию), так что оценка проходила визуально).

После починки рабочего сервера обучил модель с 9 слоями на 100 эпохах. 
Вот пример получившегося изображения ![alt text](https://raw.githubusercontent.com/AntilMB/DLS_S1_final_project/master/processed_img/zebra/067.jpg)
Переход зебра -> лошадь лучше, чем лошадь -> зебра.

### Свой проект

Возникла идея сделать сеть, которая будет конвертировать селфи людей в селфи Николоса Кейджа.
В качестве датасета A был взят [этот датасет](https://www.crcv.ucf.edu/data/Selfie/), в качестве датасета B был взят [этот датасет](https://www.cs.columbia.edu/CAVE/databases/pubfig/explore/).
Надеюсь, что появится тг с такой функцией.

**UPD**
Сервер починили, обучил модель для своего проекта. Получилось хуже, чем с зебрами. Кажется, что основная причина заключается в том, что датасет куда более плохого качества. Большая часть изображений не скачались (т.к. теперь недоступны), часть является очень низкого качества, часть вообще является скринами из фотошопа.
